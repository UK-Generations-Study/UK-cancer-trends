---
title: "PAF"
author: "Z"
format: html
editor: visual
---

## Preparing the Data

The data needs to be loaded into the program and cleaned to be usable

Loading the necessary packages

```{r}
library(dplyr)
library(tidyr)
library(stringr)
library (ggplot2)
library(gridExtra)
library(segmented)
```

Run the background code

```{r}
source("C:\\Users\\zrichards.ICR\\OneDrive - The Institute of Cancer Research\\Git\\UK-cancer-trends\\Code\\PAF\\PAFCalculations.R", echo = TRUE)

```

## Risk Factor Trends

```{r}
prev_englandwomen <- ggplot(cleanedprev %>% 
  filter (sex == "Women", country == "England"), aes(x = datayear, y = prev, color = variable)) + 
  geom_point() + 
  geom_line() +
  labs(title = "Risk Factors for Women",
       x = "Year",
       y = "Risk Factor Prevalence") +
  theme_minimal()
print(prev_englandwomen)

prev_englandmen <- ggplot(cleanedprev %>% 
  filter (sex == "Men", country == "England"), aes(x = datayear, y = prev, color = variable)) + 
  geom_point() + 
  geom_line() +
  labs(title = "Risk Factors for Men",
       x = "Year",
       y = "Risk Factor Prevalence") +
  theme_minimal()
print(prev_englandmen)
```

The Health Survey of England changed how they asked questions on alcohol consumption in 2011, but data on alcohol consumption is needed from 2005.

Alcohol prevalence was estimated for 2005-2010 based on the available data using a joint point method.

```{r}

```

## Cancer Case Trends

```{r}
#MEN
cancerratesEM <- cancerrates %>% filter(Country == "England", Sex =="Men", Year <= 2019)

# Create the plot with a separate line and prediction line for each Cancer_Site
cancercases_englandmen <- ggplot(cancerratesEM, aes(x = Year, y = Incidences, color = Cancer_Site)) + 
  geom_point() + 
  geom_line() +
  labs(title = "Cancer Incidences in England by Cancer Site for Men",
       x = "Year",
       y = "Incidence Cases") +
  theme_minimal()
print(cancercases_englandmen)


#WOMEN
cancerratesEW <- cancerrates %>% filter(Country == "England", Sex =="Women", Year <= 2019)

# Create the plot with a separate line and prediction line for each Cancer_Site
cancercases_englandwomen <- ggplot(cancerratesEW, aes(x = Year, y = Incidences, color = Cancer_Site)) + 
  geom_point() + 
  geom_line() +
  labs(title = "Cancer Incidences in England by Cancer Site for Women",
       x = "Year",
       y = "Incidence Cases") +
  theme_minimal()
print(cancercases_englandwomen)
#print 
#englandcancer <- grid.arrange(cancercases_englandmen, cancercases_englandwomen)
```

## PAF by Cancer Site

```{r}
############# MEN ###################
smoking <- PAF_all %>% filter(riskfactor == "smoking", sex == "Men")
bmi <- PAF_all %>% filter(riskfactor == "bmi", sex == "Men")
alcohol <- PAF_all %>% filter(riskfactor == "alcohol", sex == "Men")
fibre <- PAF_all %>% filter(riskfactor == "fibre", sex == "Men")
redmeat <- PAF_all %>% filter(riskfactor =="redmeat", sex == "Men")
processedmeat <- PAF_all %>% filter(riskfactor =="processedmeat", sex == "Men")
#run graphs 
#LUNG CANCER
smoking_lungmen <- ggplot(smoking, aes(x= yr, y = Lung)) + 
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.75)+xlim(2005, 2019)
#COLORECTAL CANCER
smoking_colorectalmen <- ggplot(smoking, aes(x= yr, y = Colorectal)) +
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_colorectalmen <- ggplot(bmi, aes(x= yr, y = Colorectal)) + geom_line() + geom_point() + 
  labs(title = "BMI", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.4)+xlim(2005, 2019)
alcohol_colorectalmen <- ggplot(alcohol, aes(x= yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Alcohol", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
fibre_colorectalmen <- ggplot(fibre, aes( x = yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Fibre", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
redmeat_colorectalmen <- ggplot(redmeat, aes( x = yr, y = Colorectal)) +
  geom_line() + geom_point() + 
  labs(title = "Red Meat", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
processedmeat_colorectalmen <- ggplot(processedmeat, aes( x = yr, y = Colorectal)) + geom_line() + geom_point() + 
  labs(title = "Processed Meat", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
#PANCREAS CANCER
smoking_pancreasmen <- ggplot(smoking, aes(x= yr, y = Pancreas)) +
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_pancreasmen <- ggplot(bmi, aes(x= yr, y = Pancreas)) + 
  geom_line() + geom_point() + 
  labs(title = "BMI", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
#SCC CANCER
smoking_SCCmen <- ggplot(smoking, aes(x= yr, y = SCC)) + 
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_SCCmen <- ggplot(bmi, aes(x= yr, y = SCC)) +
  geom_line() + geom_point() + 
  labs(title = "BMI", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
alcohol_SCCmen <- ggplot(alcohol, aes(x= yr, y = SCC)) + 
  geom_line() + geom_point() + 
  labs(title = "Alcohol", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
#AC CANCER
smoking_ACmen <- ggplot(smoking, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() +
  labs(title = "Smoking", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_ACmen <- ggplot(bmi, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() + 
  labs(title = "BMI", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.4)+xlim(2005, 2019)
alcohol_ACmen <- ggplot(alcohol, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() +
  labs(title = "Alcohol", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)

############# WOMEN ###################
smoking <- PAF_all %>% filter(riskfactor == "smoking", sex == "Women")
bmi <- PAF_all %>% filter(riskfactor == "bmi", sex == "Women")
alcohol <- PAF_all %>% filter(riskfactor == "alcohol", sex == "Women")
fibre <- PAF_all %>% filter(riskfactor == "fibre", sex == "Women")
redmeat <- PAF_all %>% filter(riskfactor =="redmeat", sex == "Women")
processedmeat <- PAF_all %>% filter(riskfactor =="processedmeat", sex == "Women")
#####################################################
#LUNG CANCER
smoking_lungwomen <- ggplot(smoking, aes(x= yr, y = Lung)) + 
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.75)+xlim(2005, 2019)
#COLORECTAL CANCER
smoking_colorectalwomen <- ggplot(smoking, aes(x= yr, y = Colorectal)) +
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_colorectalwomen <- ggplot(bmi, aes(x= yr, y = Colorectal)) +
  geom_line() + geom_point() + 
  labs(title = "BMI", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
alcohol_colorectalwomen <- ggplot(alcohol, aes(x= yr, y = Colorectal)) +
  geom_line() + geom_point() + 
  labs(title = "Alcohol", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
fibre_colorectalwomen <- ggplot(fibre, aes( x = yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Fibre", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
redmeat_colorectalwomen <- ggplot(redmeat, aes( x = yr, y = Colorectal)) +
  geom_line() + geom_point() + 
  labs(title = "Red Meat", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
processedmeat_colorectalwomen <- ggplot(processedmeat, aes( x = yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Processed Meat", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
#PANCREAS CANCER
smoking_pancreaswomen <- ggplot(smoking, aes(x= yr, y = Pancreas)) + 
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_pancreaswomen <- ggplot(bmi, aes(x= yr, y = Pancreas)) +
  geom_line() + geom_point() + 
  labs(title = "BMI ", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
#BREAST CANCER
bmi_breastwomen <- ggplot(bmi, aes(x= yr, y = Breast)) + 
  geom_line() + geom_point() +
  labs(title = "BMI", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
alcohol_breastwomen <- ggplot(alcohol, aes(x= yr, y = Breast)) +
  geom_line() + geom_point() +
  labs(title = "Alcohol", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
#SCC CANCER
smoking_SCCwomen <- ggplot(smoking, aes(x= yr, y = SCC)) + 
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75)+xlim(2005, 2019)
bmi_SCCwomen <- ggplot(bmi, aes(x= yr, y = SCC)) + 
  geom_line() + geom_point() + 
  labs(title = "BMI", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
alcohol_SCCwomen <- ggplot(alcohol, aes(x= yr, y = SCC)) + 
  geom_line() + geom_point() + 
  labs(title = "Alcohol", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
#AC CANCER
smoking_ACwomen <- ggplot(smoking, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() + 
  labs(title = "Smoking", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_ACwomen <- ggplot(bmi, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() + 
  labs(title = "BMI", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.4)+xlim(2005, 2019)
alcohol_ACwomen <- ggplot(alcohol, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() + 
  labs(title = "Alcohol", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45)+xlim(2005, 2019)

#print the graphs together 
Mlungcancer <- grid.arrange(smoking_lungmen, ncol = 1, top = "MEN")
Mcolorectalcancer <- grid.arrange(smoking_colorectalmen, bmi_colorectalmen, alcohol_colorectalmen, fibre_colorectalmen, redmeat_colorectalmen,processedmeat_colorectalmen, ncol = 6, top = "MEN")
Mpancreascancer <- grid.arrange(smoking_pancreasmen, bmi_pancreasmen, ncol = 2, top = "MEN")
MSCCcancer <- grid.arrange(smoking_SCCmen, bmi_SCCmen, alcohol_SCCmen, ncol = 3, top = "MEN")
MACcancer <- grid.arrange(smoking_ACmen, bmi_ACmen, alcohol_ACmen, ncol = 3, top = "MEN")
#Women
Wlungcancer <- grid.arrange(smoking_lungwomen, ncol = 1, top = "WOMEN")
Wcolorectalcancer <- grid.arrange(smoking_colorectalwomen, bmi_colorectalwomen, alcohol_colorectalwomen, fibre_colorectalwomen, redmeat_colorectalwomen, processedmeat_colorectalwomen, ncol = 6, top = "WOMEN")
Wpancreascancer <- grid.arrange(smoking_pancreaswomen, bmi_pancreaswomen,ncol = 2, top = "WOMEN")
Wbreastcancer <- grid.arrange( bmi_breastwomen, alcohol_breastwomen, ncol = 2, top = "WOMEN Estimates for Population Attributable Fractions on Breast Cancer")
WSCCcancer <- grid.arrange(smoking_SCCwomen, bmi_SCCwomen, alcohol_SCCwomen, ncol = 3, top = "WOMEN")
WACcancer <- grid.arrange(smoking_ACwomen, bmi_ACwomen, alcohol_ACwomen, ncol = 3, top = "WOMEN")
#ALL
lung <- grid.arrange(Mlungcancer, Wlungcancer, nrow=2, top = "Estimates for Population Attributable Fractions on Lung Cancer")
colorectal <- grid.arrange(Mcolorectalcancer, Wcolorectalcancer, nrow=2, top = "Estimates for Population Attributable Fractions on Colorectal Cancer" )
pancreas <- grid.arrange(Mpancreascancer, Wpancreascancer, nrow=2, top = "Estimates for Population Attributable Fractions on Pancreas Cancer")
Wbreastcancer <- grid.arrange( bmi_breastwomen, alcohol_breastwomen, nrow=2, top = "WOMEN Estimates for Population Attributable Fractions on Breast Cancer")
SCC <- grid.arrange(MSCCcancer, WSCCcancer, nrow=2, top = "Estimates for Population Attributable Fractions on SCC Cancer")
AC <- grid.arrange(MACcancer, WACcancer, nrow=2, top = "Estimates for Population Attributable Fractions on AC Cancer")

```

## PAF by Risk Factor

```{r}
############# MEN ###################
smoking <- PAF_all %>% filter(riskfactor == "smoking", sex == "Men")
bmi <- PAF_all %>% filter(riskfactor == "bmi", sex == "Men")
alcohol <- PAF_all %>% filter(riskfactor == "alcohol", sex == "Men")
fibre <- PAF_all %>% filter(riskfactor == "fibre", sex == "Men")
redmeat <- PAF_all %>% filter(riskfactor =="redmeat", sex == "Men")
processedmeat <- PAF_all %>% filter(riskfactor =="processedmeat", sex == "Men")
#####################################################
#run graphs 
#LUNG CANCER
smoking_lungmen <- ggplot(smoking, aes(x= yr, y = Lung)) + 
  geom_line() + geom_point() + 
  labs(title = "Lung Cancer", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.75)+xlim(2005, 2019)
#COLORECTAL CANCER
smoking_colorectalmen <- ggplot(smoking, aes(x= yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Colorectal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_colorectalmen <- ggplot(bmi, aes(x= yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Colorectal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.4)+xlim(2005, 2019)
alcohol_colorectalmen <- ggplot(alcohol, aes(x= yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Colorectal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
fibre_colorectalmen <- ggplot(fibre, aes( x = yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Fibre", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
redmeat_colorectalmen <- ggplot(redmeat, aes( x = yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Red Meat", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
processedmeat_colorectalmen <- ggplot(processedmeat, aes( x = yr, y = Colorectal)) + geom_line() + geom_point() + 
  labs(title = "Processed Meat", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
#PANCREAS CANCER
smoking_pancreasmen <- ggplot(smoking, aes(x= yr, y = Pancreas)) + 
  geom_line() + geom_point() + 
  labs(title = "Pancreas Cancer", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_pancreasmen <- ggplot(bmi, aes(x= yr, y = Pancreas)) + 
  geom_line() + geom_point() + 
  labs(title = "Pancreas Cancer", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
#SCC CANCER
smoking_SCCmen <- ggplot(smoking, aes(x= yr, y = SCC)) + 
  geom_line() + geom_point() + 
  labs(title = "SCC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_SCCmen <- ggplot(bmi, aes(x= yr, y = SCC)) + 
  geom_line() + geom_point() + 
  labs(title = "SCC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
alcohol_SCCmen <- ggplot(alcohol, aes(x= yr, y = SCC)) + 
  geom_line() + geom_point() + 
  labs(title = "SCC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
#AC CANCER
smoking_ACmen <- ggplot(smoking, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() + 
  labs(title = "AC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_ACmen <- ggplot(bmi, aes(x= yr, y = AC)) +
  geom_line() + geom_point() + 
  labs(title = "AC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.4)+xlim(2005, 2019)
alcohol_ACmen <- ggplot(alcohol, aes(x= yr, y = AC)) +
  geom_line() + geom_point() + 
  labs(title = "AC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)

############# WOMEN ###################
smoking <- PAF_all %>% filter(riskfactor == "smoking", sex == "Women")
bmi <- PAF_all %>% filter(riskfactor == "bmi", sex == "Women")
alcohol <- PAF_all %>% filter(riskfactor == "alcohol", sex == "Women")
fibre <- PAF_all %>% filter(riskfactor == "fibre", sex == "Women")
redmeat <- PAF_all %>% filter(riskfactor =="redmeat", sex == "Women")
processedmeat <- PAF_all %>% filter(riskfactor =="processedmeat", sex == "Women")
#####################################################
#LUNG CANCER
smoking_lungwomen <- ggplot(smoking, aes(x= yr, y = Lung)) + 
  geom_line() + geom_point() + 
  labs(title = "Lung Cancer", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.75)+xlim(2005, 2019)
#COLORECTAL CANCER
smoking_colorectalwomen <- ggplot(smoking, aes(x= yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Colorectal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_colorectalwomen <- ggplot(bmi, aes(x= yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Colorectal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
alcohol_colorectalwomen <- ggplot(alcohol, aes(x= yr, y = Colorectal)) +
  geom_line() + geom_point() + 
  labs(title = "Colorectal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
fibre_colorectalwomen <- ggplot(fibre, aes( x = yr, y = Colorectal)) + 
  geom_line() + geom_point() + 
  labs(title = "Fibre", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
redmeat_colorectalwomen <- ggplot(redmeat, aes( x = yr, y = Colorectal)) + geom_line() + geom_point() + 
  labs(title = "Red Meat", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
processedmeat_colorectalwomen <- ggplot(processedmeat, aes( x = yr, y = Colorectal)) + geom_line() + geom_point() + 
  labs(title = "Processed Meat", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.2) +xlim(2005, 2019)
#PANCREAS CANCER
smoking_pancreaswomen <- ggplot(smoking, aes(x= yr, y = Pancreas)) + 
  geom_line() + geom_point() + 
  labs(title = "Pancreas Cancer", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_pancreaswomen <- ggplot(bmi, aes(x= yr, y = Pancreas)) + 
  geom_line() + geom_point() + 
  labs(title = "Pancreas Cancer", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
#BREAST CANCER
bmi_breastwomen <- ggplot(bmi, aes(x= yr, y = Breast)) + 
  geom_line() + geom_point() +
  labs(title = "Breast Cancer", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
alcohol_breastwomen <- ggplot(alcohol, aes(x= yr, y = Breast)) +
  geom_line() + geom_point() +
  labs(title = "Breast Cancer", x = "Year", y = "PAF") +
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
#SCC CANCER
smoking_SCCwomen <- ggplot(smoking, aes(x= yr, y = SCC)) +
  geom_line() + geom_point() + 
  labs(title = "SCC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75)+xlim(2005, 2019)
bmi_SCCwomen <- ggplot(bmi, aes(x= yr, y = SCC)) +
  geom_line() + geom_point() + 
  labs(title = "SCC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.4) +xlim(2005, 2019)
alcohol_SCCwomen <- ggplot(alcohol, aes(x= yr, y = SCC)) +
  geom_line() + geom_point() + 
  labs(title = "SCC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45) +xlim(2005, 2019)
#AC CANCER
smoking_ACwomen <- ggplot(smoking, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() + 
  labs(title = "AC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.75) +xlim(2005, 2019)
bmi_ACwomen <- ggplot(bmi, aes(x= yr, y = AC)) +
  geom_line() + geom_point() + 
  labs(title = "AC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,0.4)+xlim(2005, 2019)
alcohol_ACwomen <- ggplot(alcohol, aes(x= yr, y = AC)) + 
  geom_line() + geom_point() + 
  labs(title = "AC Oesophageal Cancer", x = "Year", y = "PAF") + 
  theme_minimal () + ylim(0,.45)+xlim(2005, 2019)

#visualzing 
smokingmen <- grid.arrange(smoking_lungmen,smoking_SCCmen, smoking_ACmen, smoking_pancreasmen, smoking_colorectalmen, ncol = 5,  top = "MEN")
smokingwomen <- grid.arrange(smoking_lungwomen, smoking_SCCwomen, smoking_ACwomen, smoking_pancreaswomen, smoking_colorectalwomen,ncol = 5,  top = "WOMEN")
smoking_allcancersites <- grid.arrange(smokingmen, smokingwomen, nrow = 2, top = "Smoking as a Cancer Risk Factor")

bmimen <- grid.arrange(bmi_ACmen, bmi_colorectalmen, bmi_pancreasmen, ncol =4, top = "MEN")
bmiwomen <- grid.arrange( bmi_ACwomen, bmi_colorectalwomen, bmi_breastwomen, bmi_pancreaswomen, ncol = 4, top = "WOMEN")
bmi_allcancersites <- grid.arrange(bmimen, bmiwomen, nrow = 2, top = "BMI as a Cancer Risk Factor")

alcoholmen <- grid.arrange(alcohol_SCCmen, alcohol_colorectalmen, alcohol_ACmen, ncol=4, top = "MEN")
alcoholwomen <- grid.arrange(alcohol_SCCwomen,alcohol_breastwomen, alcohol_colorectalwomen, alcohol_ACwomen, ncol = 4, top = "WOMEN")
alcohol_allcancersites <- grid.arrange(alcoholmen, alcoholwomen, nrow=2, top = "Alcohol as a Cancer Risk Factor")

dietaryMEN <- grid.arrange(fibre_colorectalmen, redmeat_colorectalmen, processedmeat_colorectalmen, ncol=3, top = "Men")
dietaryWOMEN <- grid.arrange(fibre_colorectalwomen, redmeat_colorectalwomen,processedmeat_colorectalwomen, ncol =3, top = "Women")
dietary <- grid.arrange(dietaryMEN,dietaryWOMEN, nrow = 2,  top = "Dietary Cancer Risk Factors in Colorectal Cancer")

```

## Aggregate PAF

```{r}
aggregatepaf_plot_men <- ggplot(aggregate_paf_men, aes(x = Year, y = PAF, color = cancersite, group = cancersite)) +
  geom_line() +
  geom_point() +
  labs(title = "Aggregate PAF for Men (2005-2019)",
       x = "Year",
       y = "Cumulative PAF") +
  theme_minimal() +
  ylim(0,.75) +
  scale_x_continuous(breaks = 2005:2019, limits = c(2005, 2019)) +
  scale_color_brewer(palette = "Dark2") +
  geom_vline(xintercept = 2015, color = "red", linetype = "dashed", size = 1)  
print(aggregatepaf_plot_men)

aggregatepaf_plot_women <- ggplot(aggregate_paf_women, aes(x = Year, y = PAF, color = cancersite, group = cancersite)) +
  geom_line() +
  geom_point() +
  labs(title = "Aggregate PAF for Women(2005-2019)",
       x = "Year",
       y = "Cumulative PAF") +
  theme_minimal() +
  ylim(0,.75) +
  scale_x_continuous(breaks = 2005:2019, limits = c(2005, 2019)) +
  scale_color_brewer(palette = "Dark2") +
  geom_vline(xintercept = 2015, color = "red", linetype = "dashed", size = 1)  
print(aggregatepaf_plot_women)
```

## Attributable Cases

```{r}
mencases_visualized <- ggplot(mencases, aes(x = Yr_cases, y = attrcases, color = cancersite)) + 
  geom_point() + 
  geom_line() +
  labs(title = "Cases Attributable to Modifiable RF in England for Men",
       x = "Year",
       y = "Attributable Cases") +
  scale_x_continuous(breaks = 2015:2019, limits = c(2015, 2019)) +
  scale_color_brewer(palette = "Dark2") +
  theme_minimal() 
print(mencases_visualized)

womencases_visualized <- ggplot(womencases, aes(x = Yr_cases, y = attrcases, color = cancersite)) + 
  geom_point() + 
  geom_line() +
  labs(title = "Cases Attributable to Modifiable RF in England for Women",
       x = "Year",
       y = "Attributable Cases") +
  scale_x_continuous(breaks = 2015:2019, limits = c(2015, 2019)) +
  scale_color_brewer(palette = "Dark2") +
  theme_minimal() 
print(womencases_visualized)

```
